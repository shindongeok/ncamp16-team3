<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      class="h-full bg-white">
<head>
    <meta charset="UTF-8">
    <title>Izikgram</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <style type="text/tailwindcss">
        @theme {
            --color-main-sky-highlight: #00a3ed;
            --color-main-sky-basic: #9bdcfd;
            --color-main-red-highlight: #ff5353;
            --color-main-red-basic: #ff9898;
            --color-main-yellow-highlight: #fbc159ff;
            --color-main-yellow-basic: #fdd391;
            --color-main-black: #2C2C2C;
            /* gray-400*/
            --color-light-text: oklch(0.704 0.04 256.788);
            /* gray-600 */
            --color-basic-text: oklch(0.446 0.043 257.281);
            /* gray-900 */
            --color-bold-text: oklch(0.208 0.042 265.755);
        }
    </style>

    <link rel="stylesheet" th:href="@{/css/mainStyle.css}">
</head>
<body>
<div sec:authorize="isAuthenticated()" class="main-container relative">
    <header th:replace="~{/header :: header} " class="pt-4"></header></br></br>
    <footer th:replace="~{/footer :: footer}" class="pt-4"></footer>
    <div class="page-title">Dashboard</div>

    <div class="popular-posting-section">
        <span class="popular-board">ğŸ”¥ ì¸ê¸°ê²Œì‹œê¸€</span>
        <div class="popular-content-bubble">
            <div class="popular-content-bubble-item"
                 th:each="board, iterStat : ${@mainService.getPopularBoardList()}"
                 th:if="${iterStat.index < 3}">
                <a th:href="@{/board/{board_type}/{board_id}(board_type=${board.board_type}, board_id=${board.board_id})}"
                   class="popular-board-title-link">
                    <span class="popular-board-title" th:text="${board.title}"></span>
                    <span class="like-count">ğŸ‘ <span th:text="${board.like_count}"></span></span>
                </a>
            </div>
        </div>
    </div>

    <div class="calendar-section">
        <div class="section-title">Calendar</div>
        <div class="today-date"></div>
        <div class="calendar-wrapper">
            <div class="calendar-grid">
                <span class="day-label">M</span>
                <span class="day-label">T</span>
                <span class="day-label">W</span>
                <span class="day-label">T</span>
                <span class="day-label">F</span>
                <span class="day-label">S</span>
                <span class="day-label">S</span>
            </div>
            <div class="calendar-grid">
                <!-- JavaScriptë¡œ ë™ì  ìƒì„±ë¨ -->
            </div>
        </div>
    </div>

    <div class="overview-section">
        <div class="section-title">Overview</div>
        <div class="overview-card-section">
            <div class="overview-card">
                <div class="overview-header">
                    <span class="overview-icon">ğŸ’¸</span>
                    <div class="overview-subtitle">ì›”ê¸‰ê¹Œì§€</div>
                </div>
                <div class="overview-content" id="payday"></div>
            </div>
            <div class="overview-card">
                <div class="overview-header">
                    <span class="overview-icon">ğŸ“‰</span>
                    <div class="overview-subtitle">ì´ë²ˆì£¼ í‰ê·  í‡´ì‚¬ì§€ìˆ˜</div>
                </div>
                <div class="overview-content" id="weeklyStressNum"></div>
            </div>
        </div>
    </div>

    <div class="stress-section">
        <div class="section-title-container">
            <div class="section-title">Stress</div>
            <button class="time-settings-btn">âš™ï¸</button>
        </div>

        <div class="time-settings-modal" id="timeSettingsModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>ì‹œê°„ ì„¤ì •</h3>
                    <button class="close-modal-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="time-input-group">
                        <label for="workStartTime">ì¶œê·¼ ì‹œê°„</label>
                        <input type="time" id="workStartTime" th:value="${@mainService.getStartTime(#authentication.principal.user.member_id)}">
                    </div>
                    <div class="time-input-group">
                        <label for="lunchTime">ì ì‹¬ ì‹œê°„</label>
                        <input type="time" id="lunchTime" th:value="${@mainService.getLunchTime(#authentication.principal.user.member_id)}">
                    </div>
                    <div class="time-input-group">
                        <label for="workEndTime">í‡´ê·¼ ì‹œê°„</label>
                        <input type="time" id="workEndTime" th:value="${@mainService.getEndTime(#authentication.principal.user.member_id)}">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="save-time-btn">ì €ì¥</button>
                </div>
            </div>
        </div>

        <div class="stress-graph-section">
            <div class="container">
                <div class="progress-container">
                    <svg width="200" height="200">
                        <!-- í‡´ê·¼ê¹Œì§€ (ê°€ì¥ í° ì›) -->
                        <circle
                                cx="100"
                                cy="100"
                                r="90"
                                fill="none"
                                stroke="#C9F0FF"
                                stroke-width="15"
                        />
                        <circle
                                class="progress-circle"
                                cx="100"
                                cy="100"
                                r="90"
                                fill="none"
                                stroke="#9BDCFD"
                                stroke-width="15"
                                stroke-dasharray="565.49"
                                stroke-dashoffset="565.49"
                                stroke-linecap="round"
                                data-progress="0"
                        />
                        <circle class="circle-dot" cx="100" cy="100" r="5" color="white"/>
                        <circle class="circle-dot" cx="100" cy="10" r="5" color="white"/>

                        <!-- ì—…ë¬´ ì§„í–‰ë¥  (ì¤‘ê°„ ì›) -->
                        <circle
                                cx="100"
                                cy="100"
                                r="70"
                                fill="none"
                                stroke="#FFE5E5"
                                stroke-width="15"
                        />
                        <circle
                                class="progress-circle"
                                cx="100"
                                cy="100"
                                r="70"
                                fill="none"
                                stroke="#FF9898"
                                stroke-width="15"
                                stroke-dasharray="439.82"
                                stroke-dashoffset="439.82"
                                stroke-linecap="round"
                                data-progress="0"
                        />
                        <circle class="circle-dot" cx="100" cy="30" r="5" color="white"/>

                        <!-- ì ì‹¬ê¹Œì§€ (ê°€ì¥ ì‘ì€ ì›) -->
                        <circle
                                cx="100"
                                cy="100"
                                r="50"
                                fill="none"
                                stroke="#FFEFD7"
                                stroke-width="15"
                        />
                        <circle
                                class="progress-circle"
                                cx="100"
                                cy="100"
                                r="50"
                                fill="none"
                                stroke="#FFD188"
                                stroke-width="15"
                                stroke-dasharray="314.16"
                                stroke-dashoffset="314.16"
                                stroke-linecap="round"
                                data-progress="0"
                        />
                        <circle class="circle-dot" cx="100" cy="50" r="5" color="white"/>
                    </svg>
                </div>

                <div class="labels-container">
                    <div class="label-item">
                        <div class="color-indicator" style="background-color: #9BDCFD;"></div>
                        <span class="label-text">í‡´ê·¼ê¹Œì§€</span>
                        <span class="time-text"></span>
                    </div>
                    <div class="label-item">
                        <div class="color-indicator" style="background-color: #FF9898;"></div>
                        <span class="label-text">í‡´ì‚¬ì§€ìˆ˜</span>
                        <span class="time-text"></span>
                    </div>
                    <div class="label-item">
                        <div class="color-indicator" style="background-color: #FFD188;"></div>
                        <span class="label-text">ì ì‹¬ê¹Œì§€</span>
                        <span class="time-text"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script th:inline="javascript">
    // Spring Securityë¥¼ í†µí•´ ì „ë‹¬ë°›ì€ ë°ì´í„°ë¥¼ ì „ì—­ ë³€ìˆ˜ë¡œ ì„¤ì •
    const feelingList = /*[[${@mainService.getMonthlyFeeling(
        #authentication.principal.user.member_id,
        T(java.time.LocalDate).now().format(T(java.time.format.DateTimeFormatter).ofPattern('yyyy-MM'))
    )}]]*/ [];

    // ì›”ë³„ stressNum ë°ì´í„° ì¶”ê°€
    const monthlyStressList = /*[[${@mainService.getMonthlyStress(
        #authentication.principal.user.member_id,
        T(java.time.LocalDate).now().format(T(java.time.format.DateTimeFormatter).ofPattern('yyyy-MM'))
    )}]]*/ [];

    const payday = /*[[${@mainService.getPayday(#authentication.principal.user.member_id)}]]*/ 15;
    const startTime = /*[[${@mainService.getStartTime(#authentication.principal.user.member_id)}]]*/ '09:00';
    const lunchTime = /*[[${@mainService.getLunchTime(#authentication.principal.user.member_id)}]]*/ '12:00';
    const endTime = /*[[${@mainService.getEndTime(#authentication.principal.user.member_id)}]]*/ '18:00';
    const stressNum = /*[[${@mainService.getStressNum(#authentication.principal.user.member_id)}]]*/ 0;
</script>
<script th:src="@{/js/mainScript.js}"></script>
</body>
</html>